<!-- Created By : Pham Nguyen Binh -->

<div class="w3-container" *ngIf="sessionAddForm">
	<form class="w3-container" [formGroup]="sessionAddForm" (ngSubmit)="doSubmit()">
		<div class="w3-panel w3-round-small custom-blue">
			<h3>
				<span *ngIf="id == undefined">Tạo lớp mới</span>
				<span *ngIf="id != undefined">Cập nhật thông tin lớp học</span>
				<a routerLink="/sessions" class="w3-button w3-green custom-button">
					<i class="w3-medium fa fa-chevron-left"></i> Quay lại</a>
			</h3>
		</div>
		<div class="w3-content" style="width: 60%;">
			<!-- Class name field -->
			<label class="w3-text-blue" for="className">
				<i class="w3-medium custom-icon fa fa-university"></i>
				<b>Tên lớp học</b>
			</label>
			<input class="w3-input w3-border" type="text" formControlName="class_name" id="className">
			<div class="w3-panel w3-red" *ngIf="className.invalid && (className.dirty || className.touched)">Tên lớp học không được để trống </div>

			<!-- Start date field -->
			<label class="w3-text-blue" for="startDate">
				<i class="w3-medium custom-icon fa fa-calendar"></i>
				<b>Ngày bắt đầu</b>
			</label>
			<input class="w3-input w3-border" type="date" formControlName="start_date" id="startDate">
			<div class="w3-panel w3-red" *ngIf="startDate.invalid && (startDate.dirty || startDate.touched)">Ngày bắt đầu không được để trống </div>

			<!-- End date field -->
			<label class="w3-text-blue" for="endDate">
				<i class="w3-medium custom-icon fa fa-calendar"></i>
				<b>Ngày kết thúc</b>
			</label>
			<input class="w3-input w3-border" type="date" formControlName="end_date" id="endDate">

			<!-- Start time field -->
			<label class="w3-text-blue" for="startTime">
				<i class="w3-medium custom-icon fa fa-calendar"></i>
				<b>Bắt đầu lúc: </b>
			</label>
			<input class="w3-input w3-border" type="text" formControlName="start_time" id="startTime">

			<!-- Fee field -->
			<label class="w3-text-blue" for="fee">
				<i class="w3-medium custom-icon fa fa-money"></i>
				<b>Học phí một buổi: </b>
			</label>
			<input class="w3-input w3-border" type="text" formControlName="fee" id="fee">

			<!-- number of students field -->
			<label class="w3-text-blue">
				<i class="w3-medium custom-icon fa fa-info"></i>
				<b>Số lượng học sinh: </b>
			</label>
			<input class="w3-input w3-border" type="number" formControlName="nStudents" id="nStudents" [value]="sessionAddForm.value.nStudents">

			<!-- Add students field -->
			<label class="w3-text-blue" for="fee">
				<i class="w3-medium custom-icon fa fa-calendar"></i>
				<b>Danh sách học sinh: </b>
				<a class="w3-button w3-green custom-button" (click)="showHideSearchBox();">
					<i class="w3-small  fa fa-plus"></i> Thêm học sinh</a>
				<i class="w3-medium fa fa-search"></i>
				<div *ngIf="showSearch">
					<input *ngIf="showSearch" class="w3-input w3-border" type="text" visible="false" id="searchBox" formControlName="filter_data"
					 />
					<select (change)="onSelectStudent($event.target.value)">
						<option *ngFor="let st of students | filter:sessionAddForm.get('filter_data').value; index as i" [value]="st._id">{{st.sur_middle_name}} {{st.first_name}}</option>
					</select>
				</div>
			</label>
			<table class="w3-table w3-striped w3-bordered">
				<tr class="custom-hover-blue" *ngFor="let student of sessionAddForm.value.students | paginate: { itemsPerPage: 10, currentPage: p }; index as i;">
					<td>{{i+1}}</td>
					<td>{{student.first_name}}</td>
					<td>
						<button class="w3-red fa fa-times" (click)="onRemoveStudent(student);"></button>
					</td>
				</tr>
			</table>
			<br/>

			<button class="w3-btn w3-blue" type="submit" [disabled]="!sessionAddForm.valid">
				<span *ngIf="id == undefined">Tạo mới</span>
				<span *ngIf="id != undefined">Cập nhật</span>
				<i class="w3-medium fa fa-check"></i>
			</button>
		</div>

	</form>
</div>

<!-- Created By : Pham Nguyen Binh -->